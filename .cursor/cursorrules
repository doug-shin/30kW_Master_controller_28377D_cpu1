# C2000 F28069 프로젝트 개발 규칙 (cursorrules)

## 1. 하드웨어 및 드라이버 환경
- 프로세서: TI C2000 F28069만 사용
- TI에서 제공하는 드라이버/헤더/소스 파일은 절대 수정하지 않는다.
  - 드라이버 서포트 파일: 수정 금지
  - 헤더 파일: C:\ti\c2000\C2000Ware_DigitalPower_SDK_5_05_01_00\c2000ware\device_support\f2837xd\common\include 내 파일만 사용
  - 소스 파일: C:\ti\c2000\C2000Ware_DigitalPower_SDK_5_05_01_00\c2000ware\device_support\f2837xd\common\source 파일만 사용
  - 프로젝트 파일: C:\ti\c2000\C2000Ware_DigitalPower_SDK_5_05_01_00\c2000ware\device_support\f2837xd\common\include\DSP28x_Project.h 사용
  - 변수 타입/매크로: C:\ti\c2000\C2000Ware_DigitalPower_SDK_5_05_01_00\c2000ware\device_support\f2837xd\common\include\device.h 기준 준수
  - 드라이버라이브러리 : C:/ti/C2000Ware_5_05_00_00/driverlib/f2837xd/driverlib 파일 사용용
## 2. 코드 작성 규칙
- C 표준: C89/90 (TI C2000 컴파일러 호환)
- 주석: // 또는 /* ... */ 자유롭게 사용
- Doxygen 문서화: 요청 시에만 적용
- TI 제공 드라이버/헤더/소스 파일은 절대 수정하지 않는다. 사용자 코드에서만 기능 추가/수정
- 포팅/확장 시 TI 공식 예제 및 레퍼런스 코드 기반으로만 확장

## 3. 파일 및 경로 관리
- 헤더 파일 포함: 반드시 지정된 경로의 파일만 포함 (예: #include "F2806x_Device.h")
- 소스 파일 참조: 지정된 소스 경로만 사용
- 프로젝트 파일: DSP28x_Project.h를 메인 프로젝트 인클루드로 사용

## 4. 변수/매크로/타입
- 반드시 F2806x_Device.h 등 TI 제공 헤더의 정의를 따른다.
- 이미 정의된 변수/매크로/타입을 재정의하지 않는다.

## 5. 기타
- 코드 변경 시 변경 이력 및 목적을 주석으로 명확히 남긴다.
- 규칙 충돌 시 사용자 요구사항이 본 규칙보다 우선. 필요시 규칙 변경 가능(변경 시 명시)

# 빌드 및 커밋 정책
- 컴파일: CCS 사용, 별도 요청 없으면 시도하지 않음
- 커밋: 사용자가 직접 빌드 확인 후 커밋, 별도 요청 없으면 시도하지 않음
- Include 경로: 별도 지정하지 않으며 에러는 무시
- 프로젝트 파일: 별도 파일을 통해 드라이버 서포트 파일 포함

# 코드 수정 시 고려사항
- 드라이버 파일: 절대 수정 금지
- 핵심 제어 알고리즘: 신중하게 수정 (PI 컨트롤러, 안전 기능)
- 애플리케이션 로직: 자유롭게 수정 가능
- 통신 프로토콜: 자유롭게 수정 가능

# 성능 최적화 옵션
- DCL 라이브러리 함수 우선 고려 (약 65% 성능 향상)
- 시간 임계 함수는 RAM 실행 고려 (`#pragma CODE_SECTION`)
- 고주파 루프에서 부동소수점 연산 최소화

# 안전 기능 (유지 권장)
- 하드웨어 폴트 감지
- 과전압 보호
- 소프트 스타트 제어

# 리팩토링 지원
- 현재 구조는 참고용이며 리팩토링 시 자유롭게 변경 가능
- 사용자가 구조 변경을 원하면 해당 방향으로 지원
- 기존 구조에 얽매이지 말고 사용자 요구사항 우선

# 규칙 충돌 시 대응
- 사용자 요구사항이 규칙과 충돌하면 사용자 요구사항 우선
- 규칙 변경이 필요하면 명시적으로 안내
- "규칙에 따라 이렇게 했습니다"라고 명시하여 사용자가 판단할 수 있도록 함

# 응답 정책
- 한국어/영어 사용자 언어에 따라 응답
- 기술적 정확성 유지
- 사용자 의도 파악 우선, 규칙은 참고용으로 활용

# F28069 → F28377 포팅 정책
- C:\ti\workspace\30kW_MASTER_FPGA_without_CLA_250218G 폴더의 소스코드는 F28069 기반 마스터보드용이며, 참고용으로만 사용한다.
- 현재 작업 중인 소스코드는 F28377(2837xD) 기반으로 작성해야 한다.
- F28069 소스의 구조, 제어 알고리즘, 통신 방식, 주요 기능을 분석하여 F28377 하드웨어 및 드라이버 환경에 맞게 변환한다.
- F28069와 F28377의 드라이버, 헤더, 레지스터 구조가 다르므로, TI에서 제공하는 F28377용 드라이버/헤더만 사용한다.
- 기존 코드의 직접적인 레지스터 접근, 드라이버 함수 호출 등은 반드시 F28377용으로 대체한다.
- 포팅 시 핵심 제어 알고리즘(PI 컨트롤, 인터럽트, 통신 등)은 논리만 참고하고, 하드웨어 접근 부분은 반드시 F28377에 맞게 수정한다.
- 드라이버/헤더/소스 파일은 절대 직접 수정하지 않고, 사용자 코드에서만 변경/추가한다.
- 기존 코드의 DSP28x_Project.h, F2806x_Device.h 등은 F28377용(device.h, driverlib.h 등)으로 교체한다.
- 포팅 과정에서 구조 변경, 기능 추가/삭제 등은 자유롭게 할 수 있으며, 기존 구조에 얽매이지 않는다.
- 포팅 관련 구체적 파일/기능/모듈이 있으면 우선적으로 반영한다. 

